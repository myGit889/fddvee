<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>è®¢å•ç²˜è´´æ¿</title>
  
  <!-- PWA é…ç½® -->
  <meta name="apple-mobile-web-app-title" content="è®¢å•ç²˜è´´æ¿">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  
  <!-- å›¾æ ‡é…ç½® -->
  <link rel="apple-touch-icon" sizes="180x180" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiByeD0iMjAiIGZpbGw9IiM0Qzc5RkYiLz4KPHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHZpZXdCb3g9IjAgMCA4MCA4MCIgZmlsbD0ibm9uZSIgeD0iNTAiIHk9IjUwIj4KPHBhdGggZD0iTTQwIDEwQzQ2LjYyNzQgMTAgNTIgMTUuMzcyNiA1MiAyMlY1OEM1MiA2NC42Mjc0IDQ2LjYyNzQgNzAgNDAgNzBDMzMuMzcyNiA3MCAyOCA2NC42Mjc0IDI4IDU4VjIyQzI4IDE1LjM3MjYgMzMuMzcyNiAxMCA0MCAxMFoiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0yMiA0MEMxNS4zNzI2IDQwIDEwIDM0LjYyNzQgMTAgMjhDMTAgMjEuMzcyNiAxNS4zNzI2IDE2IDIyIDE2SDU4QzY0LjYyNzQgMTYgNzAgMjEuMzcyNiA3MCAyOEM3MCAzNC42Mjc0IDY0LjYyNzQgNDAgNTggNDBIMjJaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4KPC9zdmc+">
  <link rel="icon" type="image/x-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iIzRDNzlGRiIvPgo8cGF0aCBkPSJNMTYgNkMxNy42NTY5IDYgMTkgNy4zNDMxNSAxOSA5VjIzQzE5IDI0LjY1NjkgMTcuNjU2OSAyNiAxNiAyNkMxNC4zNDMxIDI2IDEzIDI0LjY1NjkgMTMgMjNWOUMxMyA3LjM0MzE1IDE0LjM0MzEgNiAxNiA2WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTkgMTZDNy4zNDMxNSAxNiA2IDE0LjY1NjkgNiAxM0M2IDExLjM0MzEgNy4zNDMxNSAxMCA5IDEwSDIzQzI0LjY1NjkgMTAgMjYgMTEuMzQzMSAyNiAxM0MyNiAxNC42NTY5IDI0LjY1NjkgMTYgMjMgMTZIOVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPgo=">
  
  <!-- Manifest é…ç½® -->
  <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoi5oiR55qEIFZ1ZSBXZWIgQXBwIiwic2hvcnRfbmFtZSI6IlZ1ZUFwcCIsInN0YXJ0X3VybCI6Ii8iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsInRoZW1lX2NvbG9yIjoiIzRDNzlGRiIsImJhY2tncm91bmRfY29sb3IiOiIjZmZmZmZmIiwiaWNvbnMiOlt7InNyYyI6ImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU1UZ3dJaUJvWldsbmFIUTlJakU0TUNJaVlYZERiM2c5SWpBZ01DQXhPREFnTVRnd0lpQm1hV3hzUFNKdWIyNWxJaUIwWjIxc2JuTTlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5Mekl3TURBdmMzWm5JajRLUEhKbFkzUWdkMmxrZEdnOUlqRTRNQ0lpSUdobGFXZG9kRDBpTVRnd0lpQnllRDBpTWpBaUlHWnBiR3c5SWlNMFF6YzVSa1lpTHo0S1VITjJaeUIzYVdSMGFEMGlPREFpSUdobGFXZG9kRDBpT0RBaUlIWnBaWGRDYjNnOUlqQWdNQ0E0TUNBNE1DSWdabWxzYkQwaWJtOXVaU0lnZUQwaU5UQWlJSGs5SWpVd0lqNEtVR2hoZEdnZ1pEMGlUVFF3SUFFM1F6UTJMall5TnpRZ01UY2dOVElnTVRkV05UaEROVElnTmpRdU5qSTNOQ0EwTmk0Mk1qYzBJRGN3SURRd0lEY3dRek16TGpNM01qWWdOekFnTWpnZ05qUXVOakUzTkNBeU9DQTFPRll5TWtNeU9DQXhOUzR6TnpJMklETXpMak0zTWpZZ01UQWdOREFnTVRBYUlpQm1hV3hzUFNKM2FHbDBaU0l2UGdvNGNHRjBhQ0JrUFNKTU1qSWdOREJETVRVdU16Y3lOaUEwTUNBeE1DQXpOQzQyTWpjMElERXdJakk0UXpFd0lESXhMak0zTWpZZ01UVXVNSGN5TmlBeE5pQXlNaUF4TmtoUFFrTTJOQzQyTWpjMElERTJJRGN3SURJeExqTTNNalJ1TXpjaU9IQWdOREJJTWpKYUlpQm1hV3hzUFNKM2FHbDBaU0l2UGdvOEwzTjJaejRLVEM5emRtYytJZz09IiwidHlwZSI6ImltYWdlL3N2Zyt4bWwiLCJzaXplcyI6IjE4MHgxODAifV19">
  
  <!-- Vue.js 3 CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  
  <!-- Element Plus UI ç»„ä»¶åº“ -->
  <link rel="stylesheet" href="https://unpkg.com/element-plus/dist/index.css">
  <script src="https://unpkg.com/element-plus/dist/index.full.js"></script>
  
  <!-- Element Plus å›¾æ ‡ -->
  <script src="https://unpkg.com/@element-plus/icons-vue/dist/index.iife.js"></script>
  
  <!-- Animate.css åŠ¨ç”»åº“ -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    
    #app {
      min-height: 100vh;
      display: flex;
      /* align-items: center; */
      justify-content: center;
      padding: 0.3rem;
    }
    
    .main-container {
      max-width: 500px;
      width: 100%;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(15px);
      border-radius: 0.5rem;
      padding: 40px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: space-between;
    }
    .tabs-container{
      width: 100%;
      flex: 1;
      border-radius: 0.3rem;
      overflow: hidden;
      margin-top: 0.5rem;
    }
    .data-content{
      display: flex;
      justify-content: flex-start;
      margin-bottom: 1rem;
      flex-direction: column;
      flex-wrap: wrap;
      align-items: flex-start;
      border: 1px solid rgba(0,0,0,0.1);
      padding: 0.8rem;
      border-radius: 0.3rem;
    }
    .use-status{
      font-size: 0.8rem;
      margin: 0.6rem 0;
    }
    .is-use{
      color: #f3f3f3;
    }
    .time-row {
      width: 100%;
      font-size: 0.8rem;
      margin: 0.6rem 0;
      margin-bottom: 0.6rem; 
      display: flex;
      color: #666;
      justify-content: space-between;
    }
    .btn-group{
      width: 100%;
      display: flex;
      justify-content: flex-end;
      align-items: center;
    }
    
    .app-icon {
      font-size: 80px;
      margin-bottom: 20px;
      background: white;
      width: 120px;
      height: 120px;
      border-radius: 25px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 30px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }
    
    .main-title {
      color: white;
      font-size: 2.5em;
      font-weight: 300;
      margin-bottom: 15px;
    }
    
    .subtitle {
      color: rgba(255, 255, 255, 0.9);
      font-size: 1.1em;
      margin-bottom: 30px;
      line-height: 1.6;
    }
    
    .el-card {
      background: rgba(255, 255, 255, 0.95) !important;
      border: none !important;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1) !important;
    }
    
    .feature-card {
      margin-bottom: 20px;
      text-align: left;
    }
    
    .install-steps {
      padding: 0;
      list-style: none;
    }
    
    .install-steps li {
      padding: 10px 0;
      border-bottom: 1px solid #f0f0f0;
      display: flex;
      align-items: center;
    }
    
    .install-steps li:last-child {
      border-bottom: none;
    }
    
    .step-number {
      background: #409eff;
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      margin-right: 15px;
      flex-shrink: 0;
    }
    
    @media (max-width: 768px) {
      .main-container {
        padding: 0.5rem;
        margin: 10px;
      }
      
      .main-title {
        font-size: 2em;
      }
      
      .app-icon {
        width: 80px;
        height: 80px;
        font-size: 40px;
      }
    }
    
    .fade-enter-active, .fade-leave-active {
      transition: opacity 0.5s ease;
    }
    
    .fade-enter-from, .fade-leave-to {
      opacity: 0;
    }
  </style>
</head>
<body>
  <div id="app">
    <div class="main-container">
      <div v-if="isPWA" style="width: 100%; margin-bottom: 10px;">
        <el-button style="width: 100%;" type="warning" round @click="handleImport()">å¯¼å…¥</el-button>
      </div>
      <el-tabs v-if="isPWA" v-model="activeName" type="border-card" class="tabs-container" @tab-click="handleClick">
        <el-tab-pane 
          v-for="(item,index) in tabsList" 
          :key="index" 
          :label="item.label" 
          :name="item.name"
        > 
          <div class="data-content" :style="{'color': citem.isAfterSale ? 'red' : '#666'}" v-for="(citem,cindex) in dataList" :key="cindex">
            <div style="word-break: break-all; text-align: left;">{{ citem.content }}</div>
            <!-- é»˜è®¤éšè— -->
            <div class="use-status" :style="{'visibility': (citem.isUse || citem.isCopy || citem.isAfterSale) ? 'visible' : 'hidden'}">
              {{ citem.isAfterSale ? 'å”®å' : citem.isUse ? 'å·²ç”¨' :  citem.isCopy ? 'å·²ç”¨' : '' }}
            </div>
            <div class="use-status time-row">
              <span>å¯¼å…¥æ—¶é—´: {{ citem.date }}</span>
              <span>åºå·: {{ citem.id }}</span>
            </div>
            <div class="btn-group">
              <!-- <el-button :plain="!citem.isAfterSale" type="primary" @click="handleClickBtn(citem, 'isAfterSale')">å”®å</el-button>
              <el-button :plain="!citem.isUsed" type="success" @click="handleClickBtn(citem, 'isUsed')">å·²ç”¨</el-button>
              <el-button :plain="!citem.isCopy" type="warning" @click="handleClickBtn(citem, 'isCopy')">å¤åˆ¶</el-button> -->
              <el-button plain :type="citem.isAfterSale ? 'info' : 'primary'" @click="handleClickBtn(citem, 'isAfterSale')">å”®å</el-button>
              <el-button plain :type="citem.isUse ? 'info' : 'success'" @click="handleClickBtn(citem, 'isUse')">å·²ç”¨</el-button>
              <el-button plain :type="citem.isCopy ? 'info' : 'warning'" @click="handleClickBtn(citem, 'isCopy')">å¤åˆ¶</el-button>
            </div>
          </div>
        </el-tab-pane>
      </el-tabs>

      <el-dialog v-model="dialogFormVisible" title="è¯·å¤åˆ¶å†…å®¹,ä¸€è¡Œä¸€ä¸ª" width="90vw" @close="handleCloseDialog">
        <el-form :model="form" label-position="top">
          <el-form-item :label-width="formLabelWidth">
            <el-input v-model="form.content" type="textarea" :rows="10" autocomplete="off" />
          </el-form-item>
        </el-form>
        <template #footer>
          <div class="dialog-footer">
            <el-button @click="handleCloseDialog()">å–æ¶ˆ</el-button>
            <el-button type="primary" @click="handleConfirmDialog()">
              ç¡®å®š
            </el-button>
          </div>
        </template>
      </el-dialog>
      
      <!-- PWA çŠ¶æ€æç¤º -->
      <!-- <transition name="fade">
        
      </transition> -->
      
      <!-- å®‰è£…æŒ‡å— -->
      <div v-if="!isPWA" class="animate__animated animate__fadeInUp animate__delay-2s">
        <div class="app-icon animate__animated animate__bounceIn">
          {{ appIcon }}
        </div>
        
        <h1 class="main-title animate__animated animate__fadeInUp">
          {{ appTitle }}
        </h1>
        
        <p class="subtitle animate__animated animate__fadeInUp animate__delay-1s">
          {{ appSubtitle }}
        </p>
        <el-card class="feature-card" shadow="hover">
          <template #header>
            <div style="display: flex; align-items: center; justify-content: center;">
              <el-icon style="margin-right: 8px; font-size: 20px;"><Mobile /></el-icon>
              <span>å®‰è£…åˆ°ä¸»å±å¹•</span>
            </div>
          </template>
          
          <el-alert
            :title="browserGuide.title"
            :description="browserGuide.description"
            :type="browserGuide.type"
            center
            show-icon
            :closable="false"
            style="margin-bottom: 20px;"
          />
          
          <ol class="install-steps">
            <li v-for="(step, index) in installSteps" :key="index">
              <div class="step-number">{{ index + 1 }}</div>
              <span>{{ step }}</span>
            </li>
          </ol>
        </el-card>
        
        <el-card class="feature-card" shadow="hover">
          <template #header>
            <div style="display: flex; align-items: center; justify-content: center;">
              <el-icon style="margin-right: 8px; font-size: 20px;"><Star /></el-icon>
              <span>å®‰è£…åçš„ä¼˜åŠ¿</span>
            </div>
          </template>
          
          <el-row :gutter="20">
            <el-col :span="12" v-for="feature in features" :key="feature.icon">
              <div style="text-align: center; padding: 10px;">
                <el-icon style="font-size: 24px; color: #409eff; margin-bottom: 10px;">
                  <component :is="feature.icon" />
                </el-icon>
                <div style="font-size: 14px; color: #666;">{{ feature.text }}</div>
              </div>
            </el-col>
          </el-row>
        </el-card>
      </div>
    </div>
  </div>
  
  <script>
    // ä½¿ç”¨ç±»ä¼¼ setup è¯­æ³•ç³–çš„ç»“æ„
    const { createApp, ref, computed, onMounted, reactive } = Vue;
    const { ElMessage } = ElementPlus;
    const icons = ElementPlusIconsVue;
    
    // ä»¥ä¸‹ä»£ç ç»“æ„ç±»ä¼¼äº <script setup> è¯­æ³•ç³–çš„ç»„ç»‡æ–¹å¼
    function useAppData() {
      // å“åº”å¼æ•°æ®å®šä¹‰ï¼ˆåœ¨çœŸæ­£çš„ setup è¯­æ³•ç³–ä¸­è¿™äº›ä¼šè‡ªåŠ¨æš´éœ²ï¼‰
      const appTitle = ref('æ¬¢è¿ä½¿ç”¨ è®¢å•ç²˜è´´æ¿');
      const appSubtitle = ref('åŸºäº Vue 3 + Element Plus æ„å»ºçš„ç°ä»£åŒ– PWA åº”ç”¨');
      const appIcon = ref('ğŸ“±');
      const activeName = ref('all');
      const tabsList = ref([
        { name: 'all', label: 'å…¨éƒ¨' },
        { name: 'notUse', label: 'æœªä½¿ç”¨' },
        { name: 'use', label: 'ä½¿ç”¨' },
        { name: 'afterSale', label: 'å”®å' },
        // { name: 'export', label: 'å¯¼å‡º' },
      ]);
      const dataList = ref([]);
      const dialogFormVisible = ref(false);
      const formLabelWidth = '140px';

      const form = reactive({
        content: '',
        
      });

      const filters = {
        all: () => true,
        notUse: item => !item.isUse && !item.isCopy && !item.isAfterSale,
        use: item => item.isUse,
        afterSale: item => item.isAfterSale,
        export: item => item.isExport,
      };
      
      // äº‹ä»¶å¤„ç†å‡½æ•°
      const handleClick = (tab, event) => {
        const historyList = JSON.parse(localStorage.getItem('dataList')) || [];
        const filterFn = filters[tab.props.name] || filters.all;
        console.log(filterFn);
        dataList.value = historyList.filter(filterFn);
        console.log('ç­›é€‰ç»“æœï¼š', dataList.value);
      };

      const handleClickBtn = async (item, type) => {
        if(type === 'isAfterSale'){
          item.isUse = false;
        }else if(type === 'isUse'){
          item.isAfterSale = false;
        }else if(type === 'isCopy'){
          // å¤åˆ¶åˆ°å‰ªè´´æ¿
          await navigator.clipboard.writeText(item.content);
          console.log('å¤åˆ¶æˆåŠŸ:', item.content);
           ElMessage({
            message: "å¤åˆ¶æˆåŠŸ",
            type: 'success',
          });
        }
        console.log("item", item);
        if (!item[type]) {
          item[type] = true;
          

          let dataList = [];
          try {
            const stored = localStorage.getItem('dataList');
            dataList = stored ? JSON.parse(stored) : [];
          } catch (e) {
            console.warn('dataList è§£æå¤±è´¥ï¼Œé‡ç½®ä¸ºç©ºæ•°ç»„');
            dataList = [];
          }

          // æ ¹æ® id æ‰¾åˆ°å¯¹åº”çš„æ•°æ®
          const updateIndex = dataList.findIndex(hitem => hitem.id === item.id);

          if (updateIndex !== -1) {
            // æ›¿æ¢åŸæ¥çš„å¯¹è±¡
            dataList.splice(updateIndex, 1, item);
          } else {
            // å¦‚æœæ²¡æ‰¾åˆ°ï¼Œè¯´æ˜ localStorage é‡Œè¿˜æ²¡æœ‰è¿™æ¡æ•°æ®
            dataList.unshift(item);
          }

          // å­˜å› localStorage
          localStorage.setItem('dataList', JSON.stringify(dataList));
        }
        getHistoryList(activeName.value)
        console.log('ç‚¹å‡»äº†æŒ‰é’®ï¼š', item, type);
      };

      // å¯¼å…¥æ•°æ®
      const handleImport = () => {
        dialogFormVisible.value = true;
      };

      const handleCloseDialog = () => {
        dialogFormVisible.value = false;
      };

      const handleConfirmDialog = () => {
        const formList = form.content.split('\n');
        getDataList(formList);
        dialogFormVisible.value = false;
      };

      const generateId = () => {
        const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
        
        // å‰ä¸¤ä½å­—æ¯éšæœºç”Ÿæˆ
        const prefix = letters.charAt(Math.floor(Math.random() * letters.length)) +
                      letters.charAt(Math.floor(Math.random() * letters.length));

        // åå…«ä½æ•°å­—éšæœºç”Ÿæˆ
        let numberPart = '';
        for (let i = 0; i < 8; i++) {
          numberPart += Math.floor(Math.random() * 10); // 0~9 éšæœºæ•°
        }

        return prefix + numberPart;
      };
      const getDataList = (formList) => {
        const now = getDateTime();
        console.log(formList);

        const newData = formList.map((item, index) => ({
          content: item,
          isCopy: false,      // æ˜¯å¦å·²å¤åˆ¶
          isUse: false,       // æ˜¯å¦å·²ä½¿ç”¨
          isAfterSale: false, // æ˜¯å¦å”®å
          isExport: false,    // æ˜¯å¦å¯¼å‡º
          date: now,
          id: generateId(),
        }));

        let historyList = [];
        try {
          const stored = localStorage.getItem('dataList');
          historyList = stored ? JSON.parse(stored) : [];
        } catch (e) {
          console.warn('æœ¬åœ°å­˜å‚¨è§£æå¤±è´¥ï¼Œé‡ç½®ä¸ºç©ºæ•°ç»„');
          historyList = [];
        }

        // æ–°æ•°æ®æ”¾å‰é¢
        const mergedList = [...newData, ...historyList];

        localStorage.setItem('dataList', JSON.stringify(mergedList));
        dataList.value = mergedList;

        console.log('getDataList è¢«è°ƒç”¨äº†ï¼Œæ•°æ®åˆ—è¡¨ï¼š', mergedList);
      };

      const getDateTime = () => {
        const now = new Date();

        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0'); // æœˆä»½ä»0å¼€å§‹ï¼Œæ‰€ä»¥+1
        const day = String(now.getDate()).padStart(2, '0');

        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');

        return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`;
      }

      const getHistoryList = (type = 'all') => { 
        const historyList = JSON.parse(localStorage.getItem('dataList')) || [];
        const filterFn = filters[type] || filters.all;
        dataList.value = historyList.filter(filterFn);
        return historyList.filter(filterFn);
      }
      
      // åœ¨æ™®é€šå‡½æ•°ä¸­ä»éœ€è¦ returnï¼Œä½†è¿™æ¨¡æ‹Ÿäº† setup è¯­æ³•ç³–çš„è‡ªåŠ¨æš´éœ²
      return { 
        appTitle, 
        appSubtitle, 
        appIcon, 
        activeName, 
        handleClick, 
        dataList,
        tabsList,
        getDataList,
        handleClickBtn,
        handleImport,
        dialogFormVisible,
        form,
        handleCloseDialog,
        handleConfirmDialog,
        getHistoryList,
      };
    }
    
    function usePWADetection() {
      // PWA æ£€æµ‹é€»è¾‘
      const isPWA = computed(() => {
        return window.matchMedia('(display-mode: standalone)').matches || 
               window.navigator.standalone === true;
      });
      
      return { isPWA };
    }
    
    function useBrowserDetection() {
      // æµè§ˆå™¨æ£€æµ‹é€»è¾‘
      const browserType = computed(() => {
        const ua = navigator.userAgent;
        if (ua.includes('Safari') && !ua.includes('Chrome')) {
          return 'safari';
        } else if (ua.includes('Chrome')) {
          return 'chrome';
        } else if (ua.includes('Firefox')) {
          return 'firefox';
        }
        return 'other';
      });
      
      const browserGuide = computed(() => {
        const guides = {
          safari: {
            title: 'Safari æµè§ˆå™¨æ£€æµ‹',
            description: 'ç‚¹å‡»åº•éƒ¨çš„åˆ†äº«æŒ‰é’® ğŸ“¤ï¼Œç„¶åé€‰æ‹©"æ·»åŠ åˆ°ä¸»å±å¹•"',
            type: 'info'
          },
          chrome: {
            title: 'Chrome æµè§ˆå™¨æ£€æµ‹',
            description: 'ç‚¹å‡»èœå•æŒ‰é’® â‹®ï¼Œç„¶åé€‰æ‹©"æ·»åŠ åˆ°ä¸»å±å¹•"æˆ–"å®‰è£…åº”ç”¨"',
            type: 'success'
          },
          firefox: {
            title: 'Firefox æµè§ˆå™¨æ£€æµ‹',
            description: 'ç‚¹å‡»èœå•æŒ‰é’®ï¼ŒæŸ¥æ‰¾"å®‰è£…"æˆ–"æ·»åŠ åˆ°ä¸»å±å¹•"é€‰é¡¹',
            type: 'warning'
          },
          other: {
            title: 'æµè§ˆå™¨å·²æ£€æµ‹',
            description: 'æŸ¥æ‰¾"æ·»åŠ åˆ°ä¸»å±å¹•"æˆ–"å®‰è£…"ç›¸å…³é€‰é¡¹',
            type: 'info'
          }
        };
        return guides[browserType.value] || guides.other;
      });
      
      const installSteps = computed(() => {
        const steps = {
          safari: [
            'ç‚¹å‡»åº•éƒ¨çš„åˆ†äº«æŒ‰é’® ğŸ“¤',
            'åœ¨å¼¹å‡ºèœå•ä¸­æ‰¾åˆ°"æ·»åŠ åˆ°ä¸»å±å¹•"',
            'ç‚¹å‡»"æ·»åŠ åˆ°ä¸»å±å¹•"',
            'ç¡®è®¤å®‰è£…ï¼Œå®Œæˆååœ¨æ¡Œé¢æ‰¾åˆ°åº”ç”¨å›¾æ ‡'
          ],
          chrome: [
            'ç‚¹å‡»å³ä¸Šè§’çš„èœå•æŒ‰é’® â‹®',
            'é€‰æ‹©"æ·»åŠ åˆ°ä¸»å±å¹•"æˆ–"å®‰è£…åº”ç”¨"',
            'åœ¨å¼¹å‡ºå¯¹è¯æ¡†ä¸­ç‚¹å‡»"å®‰è£…"',
            'å®‰è£…å®Œæˆï¼Œåº”ç”¨å°†å‡ºç°åœ¨æ¡Œé¢'
          ],
          other: [
            'å¯»æ‰¾æµè§ˆå™¨çš„èœå•æˆ–è®¾ç½®æŒ‰é’®',
            'æŸ¥æ‰¾"æ·»åŠ åˆ°ä¸»å±å¹•"æˆ–"å®‰è£…"é€‰é¡¹',
            'æŒ‰ç…§æç¤ºå®Œæˆå®‰è£…è¿‡ç¨‹',
            'å®‰è£…åå³å¯ä»æ¡Œé¢å¯åŠ¨åº”ç”¨'
          ]
        };
        return steps[browserType.value] || steps.other;
      });
      
      return { browserType, browserGuide, installSteps };
    }
    
    function useFeatures() {
      // åŠŸèƒ½ç‰¹æ€§æ•°æ®
      const features = ref([
        { icon: 'Monitor', text: 'å…¨å±è¿è¡Œ' },
        { icon: 'Lightning', text: 'å¿«é€Ÿå¯åŠ¨' },
        { icon: 'Download', text: 'ç¦»çº¿ä½¿ç”¨' },
        { icon: 'StarFilled', text: 'æ¡Œé¢å›¾æ ‡' }
      ]);
      
      return { features };
    }
    
    function useLifecycle(appData) {
      // ç”Ÿå‘½å‘¨æœŸé€»è¾‘
      const { isPWA } = usePWADetection();
      
      onMounted(() => {
        // åˆå§‹åŒ–åŠ è½½æ•°æ® - ä½¿ç”¨ä¼ å…¥çš„ appData å®ä¾‹
        // const stored = localStorage.getItem('dataList');
        // let historyList = stored ? JSON.parse(stored) : [];
        // if(historyList && historyList.length > 0){
        //   appData.getHistoryList(historyList);
        // }
        if (isPWA.value) {
          appData.getHistoryList();
          // ElMessage({
          //   message: 'ğŸ‰ æ‚¨å·²æˆåŠŸå®‰è£…åº”ç”¨åˆ°ä¸»å±å¹•ï¼',
          //   type: 'success',
          //   duration: 5000
          // });
        }
      });
    }
    
    // ä¸»åº”ç”¨è®¾ç½® - ç±»ä¼¼ setup å‡½æ•°
    const app = createApp({
      setup() {
        // ç»„åˆå¼ API - ä½¿ç”¨è‡ªå®šä¹‰ hooks
        const appData = useAppData();
        const pwaDetection = usePWADetection();
        const browserDetection = useBrowserDetection();
        const featuresData = useFeatures();
        
        // æ‰§è¡Œç”Ÿå‘½å‘¨æœŸé€»è¾‘ - ä¼ å…¥ appData å®ä¾‹
        useLifecycle(appData);
        
        // è¿”å›æ‰€æœ‰å“åº”å¼æ•°æ® - ç±»ä¼¼ setup è¯­æ³•ç³–çš„è‡ªåŠ¨æš´éœ²
        return {
          ...appData,
          ...pwaDetection,
          ...browserDetection,
          ...featuresData
        };
      }
    });
    
    // æ³¨å†Œ Element Plus å›¾æ ‡ç»„ä»¶
    Object.keys(icons).forEach(key => {
      app.component(key, icons[key]);
    });
    
    // ä½¿ç”¨ Element Plus æ’ä»¶
    app.use(ElementPlus);
    
    // æŒ‚è½½åº”ç”¨
    app.mount('#app');
  </script>
</body>
</html>